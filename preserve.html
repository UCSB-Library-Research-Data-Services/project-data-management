<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Good enough practices to manage your project data - Archiving and preserving your data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Good enough practices to manage your project data</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./plan.html" rel="" target="">
 <span class="menu-text">Planning</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./manage.html" rel="" target="">
 <span class="menu-text">Managing</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./preserve.html" rel="" target="" aria-current="page">
 <span class="menu-text">Preserving</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html" rel="" target="">
 <span class="menu-text">About RDS</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
    <div class="dropdown">
      <a href="" title="" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label=""><i class="bi bi-github"></i></a>
      <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item quarto-navbar-tools ms-auto-item" href="https://github.com/UCSB-Library-Research-Data-Services/project-data-management">
            Website Code
            </a>
          </li>
          <li>
            <a class="dropdown-item quarto-navbar-tools ms-auto-item" href="https://github.com/UCSB-Library-Research-Data-Services/project-data-management/issues">
            Report an issue
            </a>
          </li>
      </ul>
    </div>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#what-scientific-products-to-preserve" id="toc-what-scientific-products-to-preserve" class="nav-link active" data-scroll-target="#what-scientific-products-to-preserve">What scientific products to preserve?</a>
  <ul class="collapse">
  <li><a href="#raw-data" id="toc-raw-data" class="nav-link" data-scroll-target="#raw-data">Raw data</a></li>
  <li><a href="#intermediate-data" id="toc-intermediate-data" class="nav-link" data-scroll-target="#intermediate-data">Intermediate data</a></li>
  <li><a href="#code" id="toc-code" class="nav-link" data-scroll-target="#code">Code</a></li>
  <li><a href="#final-products" id="toc-final-products" class="nav-link" data-scroll-target="#final-products">Final products</a></li>
  </ul></li>
  <li><a href="#choosing-a-data-repository" id="toc-choosing-a-data-repository" class="nav-link" data-scroll-target="#choosing-a-data-repository">Choosing a data repository</a>
  <ul class="collapse">
  <li><a href="#dryad" id="toc-dryad" class="nav-link" data-scroll-target="#dryad">Dryad</a></li>
  </ul></li>
  <li><a href="#sharing-your-work" id="toc-sharing-your-work" class="nav-link" data-scroll-target="#sharing-your-work">Sharing your work</a>
  <ul class="collapse">
  <li><a href="#use-open-file-formats" id="toc-use-open-file-formats" class="nav-link" data-scroll-target="#use-open-file-formats">Use open file formats</a></li>
  <li><a href="#choosing-a-license" id="toc-choosing-a-license" class="nav-link" data-scroll-target="#choosing-a-license">Choosing a license</a></li>
  </ul></li>
  <li><a href="#documenting-your-work" id="toc-documenting-your-work" class="nav-link" data-scroll-target="#documenting-your-work">Documenting your work</a>
  <ul class="collapse">
  <li><a href="#metadata" id="toc-metadata" class="nav-link" data-scroll-target="#metadata">Metadata</a></li>
  <li><a href="#readme" id="toc-readme" class="nav-link" data-scroll-target="#readme">README</a></li>
  </ul></li>
  <li><a href="#submitting-to-dryad" id="toc-submitting-to-dryad" class="nav-link" data-scroll-target="#submitting-to-dryad">Submitting to DRYAD</a></li>
  <li><a href="#data-curation-process" id="toc-data-curation-process" class="nav-link" data-scroll-target="#data-curation-process">Data curation process</a></li>
  <li><a href="#publication" id="toc-publication" class="nav-link" data-scroll-target="#publication">Publication</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Archiving and preserving your data</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>As you finalize your project, an important task is to archive your data in a publicly available repository (pending sensitivity and by non-disclosure agreement exceptions). There are a few important steps to ensure that your data can be reused by others and thus make your work more reproducible.</p>
<section id="what-scientific-products-to-preserve" class="level2">
<h2 class="anchored" data-anchor-id="what-scientific-products-to-preserve">What scientific products to preserve?</h2>
<p>Often the first question that comes to mind when starting to preserve your work is: What should I include in my data archive? Generally speaking, you want to preserve <strong>your</strong> work. This means capturing the methodology you used, the raw data you collected, any data cleaning you did, and any data and output (figure, report, etc.) you generated. Okay… so you mean everything!? Well, yes and no. Everything that was relevant to help you to come to the findings and conclusions discussed in your project report or any other publications and deliverables. Let’s break this down!</p>
<section id="raw-data" class="level3">
<h3 class="anchored" data-anchor-id="raw-data">Raw data</h3>
<p>Here are a few questions to ask yourself to determine if you should refer in your documentation to the raw data you used or also include them in your data archive.</p>
<ol type="1">
<li>The <strong>raw data is already publicly accessible</strong>, and the hosting solution (website, FTP server, etc.) seems well maintained (ideally providing a recommended citation)</li>
</ol>
<p>=&gt; Document the website or process you used to collect the data and when you accessed/downloaded the data you used. Try also to determine if a pecific version number is associated with the data you used.*</p>
<ol start="2" type="1">
<li>The raw data is <strong>not</strong> publicly accessible</li>
</ol>
<p>Note that we are not talking about data under a non-disclosure agreement (NDA) here but more about data with an unclear reuse status or obtained by interactions with a person or an institution. For example, if the data you used were sent to you privately, then we recommend that you:</p>
<ul>
<li>inquire with your person of contact about the status of licensing and if they would be willing to let you share those data publicly. You might face resistance at first, so take the time to explain why you think it is valuable to your work to also share those data sets.</li>
<li>if, in the end, it is not possible to share the data, please still describe the data in your documentation and list the contact information (person or institution) to inquire about this data set.</li>
</ul>
</section>
<section id="intermediate-data" class="level3">
<h3 class="anchored" data-anchor-id="intermediate-data">Intermediate data</h3>
<p>This is data you generated either while cleaning or analyzing the raw data. You should preserve it if:</p>
<ul>
<li>it was not directly generated by a script (otherwise, preserve the code instead)</li>
<li>it has reusable value. For example, cleaned-up versions of raw data can be very valuable for others to reuse!</li>
</ul>
</section>
<section id="code" class="level3">
<h3 class="anchored" data-anchor-id="code">Code</h3>
<p>Scripting your analytical workflow from the raw data to the end products is a great way to make your work more reproducible and more reusable by others. We thus strongly encourage your team to develop code to process and analyze data. Cloud-based code repository services, such as GitHub, GitLab, BitBucket, and more, are a great way to both manage and preserve your code.</p>
<p>Those services are often well-integrated with data repositories that link your code repository with your data archive. They also offer a way to tag a specific version of your code to ensure it is the exact code you used for a specific analysis.</p>
</section>
<section id="final-products" class="level3">
<h3 class="anchored" data-anchor-id="final-products">Final products</h3>
<p>We recommend including any data set used to produce statistics, figures maps, and other visualizations that were used in your work, in this case, even if generated by scripts.</p>
</section>
</section>
<section id="choosing-a-data-repository" class="level2">
<h2 class="anchored" data-anchor-id="choosing-a-data-repository">Choosing a data repository</h2>
<p>OK, we know what we want to archive. Now let’s decide where we want to preserve things!</p>
<p>UCSB’s institutional data repository <a href="https://datadryad.org/stash">Dryad</a> will be your default data repository. However, we encourage you to discuss with your Faculty Advisor to determine if other data repositories might suit your targeted audience/community better. If you would like to research on your own which data repository could be best for your project, the <a href="https://www.re3data.org">Registry of Research Data Repositories</a> is a great resource to do so.</p>
<section id="dryad" class="level3">
<h3 class="anchored" data-anchor-id="dryad">Dryad</h3>
<p><a href="https://datadryad.org/stash">Dryad</a> is free of use for any affiliated researcher. Here is an overview of the process of submitting data to DRYAD:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/dryad_workflow.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">DRYAD data submission overview</figcaption>
</figure>
</div>
<p>Before you can start this submission process, we will describe the information you need to prepare for your data archive submission.</p>
</section>
</section>
<section id="sharing-your-work" class="level2">
<h2 class="anchored" data-anchor-id="sharing-your-work">Sharing your work</h2>
<section id="use-open-file-formats" class="level3">
<h3 class="anchored" data-anchor-id="use-open-file-formats">Use open file formats</h3>
<p>We recommend using open and text-based file formats as much as possible to make your data more accessible. It removes the need to buy specific software to open your data and ensures that this format will remain readable in the longer term.</p>
</section>
<section id="choosing-a-license" class="level3">
<h3 class="anchored" data-anchor-id="choosing-a-license">Choosing a license</h3>
<p>This can quickly become an overwhelming subject. In a nutshell, <a href="https://creativecommons.org/share-your-work/">Creative Commons licenses</a> are the ones that are favored to license data.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://upload.wikimedia.org/wikipedia/commons/a/a5/CC_License_Freedom_Scale_Chart.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Foter, CC BY-SA 3.0 <a href="https://creativecommons.org/licenses/by-sa/3.0" class="uri">https://creativecommons.org/licenses/by-sa/3.0</a>, via Wikimedia Commons</figcaption>
</figure>
</div>
<p>Note that data repositories often support a certain number of licenses, so this can be a parameter to help you choose which data repository you want to use. For example, <strong><em>DRAYD is licensing all its content under <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>, an equivalent to saying its content is in the public domain</em></strong>.</p>
<p>If you want to know more on how to best license your data, click <a href="https://www.library.ucsb.edu/sites/default/files/dls-n10-2021-licensing-navy_0.pdf">here</a></p>
</section>
</section>
<section id="documenting-your-work" class="level2">
<h2 class="anchored" data-anchor-id="documenting-your-work">Documenting your work</h2>
<p>To make your archiving process the most efficient, it is key to document your work as you progress throughout your project. If you do so, archiving your data will consist of collecting existing information about the various parts of your project rather than developing it from scratch a few months after you have generated this specific dataset.</p>
<p>Add an image about the power of README</p>
<section id="metadata" class="level3">
<h3 class="anchored" data-anchor-id="metadata">Metadata</h3>
<p>Metadata aims at describing your data with enough information that should let you be able to reuse this data even if you know nothing about this specific dataset. It is sometimes defined as data about data. So what should you include? Here are some pointers:</p>
<ul>
<li>Describe the contents of data files. If you are using complex jargon or concepts make sure you refer to external vocabulary or clearly define these terms as used in your project</li>
<li>Keep data entry consistent</li>
<li>Define the parameters and the units on the parameter</li>
<li>Explain the formats for date, time, geographic coordinates, and other parameters</li>
<li>Define any coded values or acronyms used (in the data or headers)</li>
<li>Describe quality flags or qualifying values</li>
<li>Define missing values</li>
<li>Always use an established metadata standard</li>
</ul>
<p>Note that there are existing metadata standards that can help you to structure your data in a systematic way. Some data repositories offer web forms that let you enter metadata information in a way that is compatible with those standards.</p>
</section>
<section id="readme" class="level3">
<h3 class="anchored" data-anchor-id="readme">README</h3>
<p>README files are not new; they have been around computer-based projects since the early days and have proven to be very valuable in describing content. For your main project README we recommend compiling the following information about your data:</p>
<ul>
<li>Data sources: where did you get your raw data from?</li>
<li>Provenance: what data set you used/combined to generate your new data</li>
<li>License &amp; permissions: state under which license your data sets are released so others know what they can do with your data</li>
<li>Methodology: describe the methodology used for your projects</li>
<li>Data listing: list all your data and their potential relationships</li>
<li>Metadata: add the metadata you developed earlier for each of your data set</li>
</ul>
<p>Note that you should not feel limited to one README only. It is a great practice to also have READMEs in any subfolder/section of your project with complex organization and explanations on how to navigate the file structure or in which order files should be combined.</p>
<p>Our team has prepared a <a href="./templates/README-Template-EDS213.html">README template</a> for your submission to Dryad. Note that some sections might not be relevant to your project, and you should simply delete those as you move through filling out this template.</p>
</section>
</section>
<section id="submitting-to-dryad" class="level2">
<h2 class="anchored" data-anchor-id="submitting-to-dryad">Submitting to DRYAD</h2>
<p>You are now ready to start the submission process!! Here we are going to use DRYAD as an example.</p>
<ul>
<li>Before logging into Dryad, you must create a free <a href="https://info.orcid.org/what-is-orcid/">ORCID</a>. ORCIDs are free, unique identifiers for yourself. Think of it as a Social Security Number for Researchers that, this time, you can share. Create your account <a href="https://orcid.org/register">here</a>.</li>
<li>Then you can <a href="https://datadryad.org/stash/sessions/choose_login">login</a> and should land on a page as below. Click on the <code>Start new dataset</code> button</li>
</ul>
<p><img src="images/dryad_landing-page.png" class="img-fluid"></p>
<ul>
<li>You will now have to fill out the web form to provide project-level information, starting with the <em>Preliminary information</em> section. Select <code>other or not applicable</code> as your submission is not related to a journal publication.</li>
</ul>
<p><img src="images/dryad_preliminary.png" class="img-fluid"></p>
<ul>
<li>Fill the <em>Basic information</em> section
<ul>
<li><em>Title</em>: Note it can be different than your project a describing as much as possible your data archive content</li>
<li><em>Authors</em>: enter all your teammates</li>
<li><em>Research domain</em>: Choose the more relevant to your project</li>
<li><em>Funding</em>: check the <code>No Funding received box</code> or enter any external funding you received for this project</li>
<li><em>Abstract</em>: enter a short description of your work</li>
</ul></li>
<li><em>Data Description</em> section:
<ul>
<li><em>Keywords</em>: add relevant keywords and please make sure to add the Bren project keyword <code>BrenMESMProject</code></li>
<li><em>Methods</em>: describe the methods you used for your analysis</li>
<li><em>Usage notes</em>: you can add any software you used to conduct your project here. please provide the version number along with the software name</li>
</ul></li>
<li><em>Related work</em> section:
<ul>
<li>This is where you can link your data repository on GitHub with your data archive. Select <code>Software</code> as <em>Work type</em> and paste the URL to your repository. Do not forget to also provide the necessary information on the README on your code repository. Once your data archive is published on DRYAD, do not forget to add the link to README on GitHub, linking the resources both ways.</li>
</ul></li>
</ul>
<p><img src="images/dryad_related-work.png" class="img-fluid"></p>
<p><strong><em>DRYAD full Submission and publication guidelines: <a href="https://datadryad.org/stash/submission_process" class="uri">https://datadryad.org/stash/submission_process</a></em></strong></p>
</section>
<section id="data-curation-process" class="level2">
<h2 class="anchored" data-anchor-id="data-curation-process">Data curation process</h2>
<p>OK, you have submitted your data and its documentation to the DRYAD (or others) data repository, what is next!? Most of the data repository will have some level of data curation process, mainly a series of checks that will ensure that you provided all the necessary documentation to make your research work understandable to others. Some of those checks might be done automatically (leveraging metadata standards, for example), some others will be done by data curators associated with the data repository. In the coming days of your submission to DRYAD, a curator will reach out to you with a list of items to improve. For example replacing and Excel spreadsheets (proprietary software) with csv files that can be more easily open, especially in several years from now. Adding more information about the raw data you used or clarifying their licensing, provide more details about your methodology. Once this feedback received, you will have to iterate through those recommendations as needed and resubmit your updated documentation and data. You can expect the curation process to take several days to potentially a few weeks. Therefore plan accordingly!!</p>
</section>
<section id="publication" class="level2">
<h2 class="anchored" data-anchor-id="publication">Publication</h2>
<p>Once the curation process is over, your data will be publish and made publicly available. Most of the data repository provide a <a href="https://www.doi.org/the-identifier/what-is-a-doi/">DOI</a> to reference your data archive. Use this DOI to share and cite your data archive in your project report and publications!!</p>


</section>

</main> <!-- /main -->
<div>
  <p></p><hr><p></p>
  <p align="center"><a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a></p>
  <p align="center"><a href="https://www.library.ucsb.edu/research-data-services"><img alt="UCSB logo" style="border-width:0" src="images/ucsb-primary-wordmark.png" width="250px" align="center"></a></p>
</div>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>